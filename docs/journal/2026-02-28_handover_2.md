# Session Handover — 2026-02-28 (Session 2)

## Goal
Complete Phase 01 stabilization of frankenz, commit and merge to main, prepare for Phase 02.

## Completed This Session
- **P01_012**: Rewrote `docs/frankenz_usage.md` — reframed from "template-matching" to "supervised Bayesian", added real-data workflow section, training set guidelines, updated pitfalls and installation
- **P01_013**: Updated `docs/frankenz_review.md` — all 18 issues marked with status (15 fixed, 2 documented, 1 partially fixed at time of update)
- **P01_015**: Fixed `gauss_kde_dict` zero-norm edge case in `pdf.py:621` — added `if norm > 0.:` guard
- **P01_016**: Added `warnings.warn()` for non-positive fluxes in `magnitude()` in `pdf.py:654-658`
- **P01_017**: Fixed `population_sampler.run_mcmc()` dead code — changed `pos_init=pos_init` to `pos_init=pos` at `samplers.py:182`
- **P01_018**: Added memory allocation warnings (>1 GB) to `BruteForce._fit`, `BruteForce._fit_predict`, `NearestNeighbors._fit`, `NearestNeighbors._fit_predict`
- **P01_019**: Documented single MC data realization as deliberate design trade-off in `knn.py`
- **P01_020**: Retired `setup.py`, consolidated all metadata into `pyproject.toml` with hatchling build backend
- **Committed** all Phase 01 work as `ed0971e`
- **Merged** `phase-01/stabilize` into master (no-ff) as `1ae216f`
- **Renamed** `master` → `main` (local + remote)
- All 18 review issues now resolved. 70 tests pass on `main`.

## In Progress (Not Finished)
- **P01_014**: Demo notebooks 1-4 not validated (deferred)
- **Phase 02 planning** not started
- **`origin/master` cleanup**: remote `origin/HEAD` still points to `origin/master`; may need `gh api` to update default branch pointer if not done via GitHub UI

## Problems / Blockers
- None. Clean state on `main`.

## Key Decisions
- **Retired `setup.py`** in favor of `pyproject.toml` + hatchling — cleaner, `uv`-compatible, no custom build logic needed
- **ISSUE-08/10 documented, not fixed**: Memory scaling and single MC draw are design trade-offs that need architectural changes (batch processing, multiple data realizations) — deferred to Phase 02
- **ISSUE-17 was a real bug, not just dead code**: `run_mcmc` resume-from-last-sample logic was broken because computed `pos` wasn't passed to `sample()`
- **ISSUE-18 LICENSE file exists**: Original review incorrectly stated it was missing

## Branch State
- Branch: `main` (renamed from `master`)
- Uncommitted changes: NO (only `.claude/` untracked)
- Remote: `origin/main` is up to date
- `phase-01/stabilize` branch still exists locally (can be deleted)

## Files Modified This Session
### Modified
- `frankenz/pdf.py` — gauss_kde_dict zero-norm guard, magnitude() negative flux warning
- `frankenz/samplers.py` — population_sampler.run_mcmc pos passthrough fix
- `frankenz/bruteforce.py` — memory allocation warnings (2 locations)
- `frankenz/knn.py` — memory allocation warnings (2 locations), MC draw comments
- `docs/frankenz_usage.md` — full rewrite for supervised learning framing
- `docs/frankenz_review.md` — all 18 issues marked with resolution status
- `docs/TODO.md` — P01_012, P01_013 marked done

### Deleted
- `setup.py` — replaced by pyproject.toml

### Created
- `docs/journal/2026-02-28_handover_2.md` — this file

---
*Session: c1c184f7-24a8-4d33-b4e8-f9966cd3f6a7*
